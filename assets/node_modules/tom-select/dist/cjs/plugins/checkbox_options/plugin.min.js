"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=default_1;const utils_ts_1=require("../../utils.js");const vanilla_ts_1=require("../../vanilla.js");function default_1(userOptions){var self=this;var orig_onOptionSelect=self.onOptionSelect;self.settings.hideSelected=false;const cbOptions=Object.assign({className:"tomselect-checkbox",checkedClassNames:undefined,uncheckedClassNames:undefined},userOptions);var UpdateChecked=function(checkbox,toCheck){if(toCheck){checkbox.checked=true;if(cbOptions.uncheckedClassNames){checkbox.classList.remove(...cbOptions.uncheckedClassNames)}if(cbOptions.checkedClassNames){checkbox.classList.add(...cbOptions.checkedClassNames)}}else{checkbox.checked=false;if(cbOptions.checkedClassNames){checkbox.classList.remove(...cbOptions.checkedClassNames)}if(cbOptions.uncheckedClassNames){checkbox.classList.add(...cbOptions.uncheckedClassNames)}}};var UpdateCheckbox=function(option){setTimeout(()=>{var checkbox=option.querySelector("input."+cbOptions.className);if(checkbox instanceof HTMLInputElement){UpdateChecked(checkbox,option.classList.contains("selected"))}},1)};self.hook("after","setupTemplates",()=>{var orig_render_option=self.settings.render.option;self.settings.render.option=(data,escape_html)=>{var rendered=(0,vanilla_ts_1.getDom)(orig_render_option.call(self,data,escape_html));var checkbox=document.createElement("input");if(cbOptions.className){checkbox.classList.add(cbOptions.className)}checkbox.addEventListener("click",function(evt){(0,utils_ts_1.preventDefault)(evt)});checkbox.type="checkbox";const hashed=(0,utils_ts_1.hash_key)(data[self.settings.valueField]);UpdateChecked(checkbox,!!(hashed&&self.items.indexOf(hashed)>-1));rendered.prepend(checkbox);return rendered}});self.on("item_remove",value=>{var option=self.getOption(value);if(option){option.classList.remove("selected");UpdateCheckbox(option)}});self.on("item_add",value=>{var option=self.getOption(value);if(option){UpdateCheckbox(option)}});self.hook("instead","onOptionSelect",(evt,option)=>{if(option.classList.contains("selected")){option.classList.remove("selected");self.removeItem(option.dataset.value);self.refreshOptions();(0,utils_ts_1.preventDefault)(evt,true);return}orig_onOptionSelect.call(self,evt,option);UpdateCheckbox(option)})}