(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):(global=typeof globalThis!=="undefined"?globalThis:global||self,global.checkbox_options=factory())})(this,function(){"use strict";const hash_key=value=>{if(typeof value==="undefined"||value===null)return null;return get_hash(value)};const get_hash=value=>{if(typeof value==="boolean")return value?"1":"0";return value+""};const preventDefault=(evt,stop=false)=>{if(evt){evt.preventDefault();if(stop){evt.stopPropagation()}}};const getDom=query=>{if(query.jquery){return query[0]}if(query instanceof HTMLElement){return query}if(isHtmlString(query)){var tpl=document.createElement("template");tpl.innerHTML=query.trim();return tpl.content.firstChild}return document.querySelector(query)};const isHtmlString=arg=>{if(typeof arg==="string"&&arg.indexOf("<")>-1){return true}return false};function plugin(userOptions){var self=this;var orig_onOptionSelect=self.onOptionSelect;self.settings.hideSelected=false;const cbOptions=Object.assign({className:"tomselect-checkbox",checkedClassNames:undefined,uncheckedClassNames:undefined},userOptions);var UpdateChecked=function UpdateChecked(checkbox,toCheck){if(toCheck){checkbox.checked=true;if(cbOptions.uncheckedClassNames){checkbox.classList.remove(...cbOptions.uncheckedClassNames)}if(cbOptions.checkedClassNames){checkbox.classList.add(...cbOptions.checkedClassNames)}}else{checkbox.checked=false;if(cbOptions.checkedClassNames){checkbox.classList.remove(...cbOptions.checkedClassNames)}if(cbOptions.uncheckedClassNames){checkbox.classList.add(...cbOptions.uncheckedClassNames)}}};var UpdateCheckbox=function UpdateCheckbox(option){setTimeout(()=>{var checkbox=option.querySelector("input."+cbOptions.className);if(checkbox instanceof HTMLInputElement){UpdateChecked(checkbox,option.classList.contains("selected"))}},1)};self.hook("after","setupTemplates",()=>{var orig_render_option=self.settings.render.option;self.settings.render.option=(data,escape_html)=>{var rendered=getDom(orig_render_option.call(self,data,escape_html));var checkbox=document.createElement("input");if(cbOptions.className){checkbox.classList.add(cbOptions.className)}checkbox.addEventListener("click",function(evt){preventDefault(evt)});checkbox.type="checkbox";const hashed=hash_key(data[self.settings.valueField]);UpdateChecked(checkbox,!!(hashed&&self.items.indexOf(hashed)>-1));rendered.prepend(checkbox);return rendered}});self.on("item_remove",value=>{var option=self.getOption(value);if(option){option.classList.remove("selected");UpdateCheckbox(option)}});self.on("item_add",value=>{var option=self.getOption(value);if(option){UpdateCheckbox(option)}});self.hook("instead","onOptionSelect",(evt,option)=>{if(option.classList.contains("selected")){option.classList.remove("selected");self.removeItem(option.dataset.value);self.refreshOptions();preventDefault(evt,true);return}orig_onOptionSelect.call(self,evt,option);UpdateCheckbox(option)})}return plugin});