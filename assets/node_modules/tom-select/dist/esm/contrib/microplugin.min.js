export default function MicroPlugin(Interface){Interface.plugins={};return class extends Interface{constructor(){super(...arguments);this.plugins={names:[],settings:{},requested:{},loaded:{}}}static define(name,fn){Interface.plugins[name]={name:name,fn:fn}}initializePlugins(plugins){var key,name;const self=this;const queue=[];if(Array.isArray(plugins)){plugins.forEach(plugin=>{if(typeof plugin==="string"){queue.push(plugin)}else{self.plugins.settings[plugin.name]=plugin.options;queue.push(plugin.name)}})}else if(plugins){for(key in plugins){if(plugins.hasOwnProperty(key)){self.plugins.settings[key]=plugins[key];queue.push(key)}}}while(name=queue.shift()){self.require(name)}}loadPlugin(name){var self=this;var plugins=self.plugins;var plugin=Interface.plugins[name];if(!Interface.plugins.hasOwnProperty(name)){throw new Error('Unable to find "'+name+'" plugin')}plugins.requested[name]=true;plugins.loaded[name]=plugin.fn.apply(self,[self.plugins.settings[name]||{}]);plugins.names.push(name)}require(name){var self=this;var plugins=self.plugins;if(!self.plugins.loaded.hasOwnProperty(name)){if(plugins.requested[name]){throw new Error('Plugin has circular dependency ("'+name+'")')}self.loadPlugin(name)}return plugins.loaded[name]}}}