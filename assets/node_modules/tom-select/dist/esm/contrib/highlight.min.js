import{replaceNode}from"../vanilla.js";export const highlight=(element,regex)=>{if(regex===null)return;if(typeof regex==="string"){if(!regex.length)return;regex=new RegExp(regex,"i")}const highlightText=node=>{var match=node.data.match(regex);if(match&&node.data.length>0){var spannode=document.createElement("span");spannode.className="highlight";var middlebit=node.splitText(match.index);middlebit.splitText(match[0].length);var middleclone=middlebit.cloneNode(true);spannode.appendChild(middleclone);replaceNode(middlebit,spannode);return 1}return 0};const highlightChildren=node=>{if(node.nodeType===1&&node.childNodes&&!/(script|style)/i.test(node.tagName)&&(node.className!=="highlight"||node.tagName!=="SPAN")){Array.from(node.childNodes).forEach(element=>{highlightRecursive(element)})}};const highlightRecursive=node=>{if(node.nodeType===3){return highlightText(node)}highlightChildren(node);return 0};highlightRecursive(element)};export const removeHighlight=el=>{var elements=el.querySelectorAll("span.highlight");Array.prototype.forEach.call(elements,function(el){var parent=el.parentNode;parent.replaceChild(el.firstChild,el);parent.normalize()})};